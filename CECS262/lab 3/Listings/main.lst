C51 COMPILER V9.60.0.0   MAIN                                                              11/05/2021 01:22:23 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE INCDIR(C:\Keil_v5\C51\INC\SiLABS\shared\
                    -si8051Base) DEBUG OBJECTEXTEND PRINT(.\Listings\main.lst) TABS(2) OBJECT(.\Objects\main.obj)

line level    source

   1          //main.c
   2          
   3          #include <SI_EFM8BB1_Register_Enums.h>
   4          
   5          void InitDevice(void)
   6          {
   7   1        //Disable Watchdog Timer
   8   1        //Disable Watchdog with key sequence
   9   1        WDTCN = 0xDE; //First key
  10   1        WDTCN = 0xAD; //Second key
  11   1        // [WDTCN – Watchdog Timer Control]$
  12   1      
  13   1        //Setup Defaults for P1
  14   1        P1MDOUT = P1MDOUT_B0__OPEN_DRAIN | P1MDOUT_B1__OPEN_DRAIN
  15   1        | P1MDOUT_B2__OPEN_DRAIN | P1MDOUT_B3__OPEN_DRAIN
  16   1        | P1MDOUT_B4__PUSH_PULL | P1MDOUT_B5__OPEN_DRAIN
  17   1        | P1MDOUT_B6__OPEN_DRAIN | P1MDOUT_B7__OPEN_DRAIN;
  18   1      
  19   1        //Enable Weak Pullups
  20   1        XBR2 = XBR2_WEAKPUD__PULL_UPS_ENABLED | XBR2_XBARE__ENABLED;
  21   1      
  22   1        //Disable Interrupts
  23   1        IE = IE_EA__DISABLED | IE_EX0__DISABLED | IE_EX1__DISABLED
  24   1        | IE_ESPI0__DISABLED | IE_ET0__DISABLED | IE_ET1__DISABLED
  25   1        | IE_ET2__ENABLED | IE_ES0__DISABLED;
  26   1      
  27   1      }
  28          
  29          void main(void){
  30   1      
  31   1        // declare variables
  32   1        unsigned char x;
  33   1        unsigned counter, counter_limit;
  34   1        unsigned shifting;
  35   1        
  36   1        InitDevice();
  37   1        
  38   1        // initializing variables
  39   1        x = 0x01;
  40   1        counter = 0;
  41   1        shifting = 1;
  42   1        
  43   1        TMOD = 0x01;  // timer 0 16-bit mode
  44   1        TCON = TCON|(0x01<<4);  // start timer 0 
  45   1        
  46   1        // Superloop Architcture
  47   1        while(1){
  48   2          
  49   2          // check if TF = 1
  50   2          if(TCON&(0x01 << 5)){   
  51   3            // overflow has happened
  52   3            TCON = TCON&~(0x01 << 4); //stop the timer 
  53   3            
  54   3            counter += 1; // counter goes up 1
C51 COMPILER V9.60.0.0   MAIN                                                              11/05/2021 01:22:23 PAGE 2   

  55   3            
  56   3            // check if 8051 button is pressed
  57   3            if(P0&0x02<<1){
  58   4              // unpressed
  59   4              counter_limit = 5;  // half second delay
  60   4            }else{
  61   4              //pressed
  62   4              counter_limit = 10; // one second delay
  63   4            }
  64   3            
  65   3            // check counter amount 
  66   3            if(counter >= counter_limit){
  67   4              
  68   4              // check if breadboard button is pressed 
  69   4              if(P0&0x01<<1){
  70   5                P1 = ~x;  // one LED on
  71   5              }else{
  72   5                P1 = x; // one LED off
  73   5              }
  74   4              
  75   4              // check direction of shift
  76   4              if(shifting){
  77   5                x = x<<1; // shift left by one 
  78   5              }else{
  79   5                x = x>>1; // shift right by one
  80   5              }
  81   4              
  82   4              // check if LED should shift
  83   4              if(x==0x01){
  84   5                shifting = 1; // shift left
  85   5              }
  86   4              else if(x==0x01<<7){
  87   5                shifting = 0; // shift right
  88   5              }
  89   4              
  90   4              counter = 0;  // reset counter
  91   4              
  92   4            }
  93   3            
  94   3            // .1 seconds has happened
  95   3            TL0 = 0x4F;
  96   3            TH0 = 0x9C;
  97   3            
  98   3            TCON = TCON&~(0x01<<5); // clear the flag
  99   3            TCON = TCON|(0x01<<4);  // start timer 0 again 
 100   3            
 101   3          }
 102   2        }
 103   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    143    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       2
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
